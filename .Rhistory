aes(x = reorder(Question, tot_neg_scores), y=pct, fill=answer),
position=position_stack(reverse = TRUE), stat="identity") +
geom_bar(data=negatives,
aes(x =reorder(Question, tot_neg_scores), y=pct, fill=answer) ,
position="stack", stat="identity") +
scale_fill_manual(values = my_cols, breaks = ans_choices) +
geom_hline(yintercept = 0, color =c("white"), lty=2)+
scale_y_continuous(limits = c(-1,1), labels = scales::percent) +
coord_flip()+
theme_tufte()+
labs(x ='', y='Percent', fill='', title = 'Hotel Survey') +
theme(plot.title = element_text(hjust = 0.5, family = 'Arial', face='bold'),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'line'),
legend.text = element_text(size = 7, family = 'Arial'),
axis.text.y = element_text(size = 11, family = 'Arial'))
ggplot() +
geom_bar(data=positives,
aes(x = reorder(Question, tot_neg_scores), y=pct, fill=answer),
position=position_stack(reverse = TRUE), stat="identity") +
geom_bar(data=negatives,
aes(x =reorder(Question, tot_neg_scores), y=pct, fill=answer) ,
position="stack", stat="identity") +
scale_fill_manual(values = my_cols, breaks = ans_choices) +
geom_hline(yintercept = 0, color =c("white"), lty=2)+
scale_y_continuous(limits = c(-1,1), labels = scales::percent) +
coord_flip()+
#theme_tufte()+
theme_dark()+
labs(x ='', y='Percent', fill='', title = 'Hotel Survey') +
theme(plot.title = element_text(hjust = 0.5, family = 'Arial', face='bold'),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'line'),
legend.text = element_text(size = 7, family = 'Arial'),
axis.text.y = element_text(size = 11, family = 'Arial'))
ggplot() +
geom_bar(data=positives,
aes(x = reorder(Question, tot_neg_scores), y=pct, fill=answer),
position=position_stack(reverse = TRUE), stat="identity") +
geom_bar(data=negatives,
aes(x =reorder(Question, tot_neg_scores), y=pct, fill=answer) ,
position="stack", stat="identity") +
scale_fill_manual(values = my_cols, breaks = ans_choices) +
geom_hline(yintercept = 0, color =c("white"), lty=2)+
scale_y_continuous(limits = c(-1,1), labels = scales::percent) +
coord_flip()+
theme_tufte()+
labs(x ='', y='Percent', fill='', title = 'Hotel Survey') +
theme(plot.title = element_text(hjust = 0.5, size = 16, family = 'Arial', face='bold'),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'line'),
legend.text = element_text(size = 9, family = 'Arial'),
axis.text.y = element_text(size = 11, family = 'Arial'))
library(tidyverse)
library(scales)
library(ggthemes)
library(readxl)
dat <- read_excel('data/P18-Hotel-Survey-Data.xlsx', sheet = "Responses")
qmet_dat <- read_excel('data/P18-Hotel-Survey-Data.xlsx', sheet='Question Metadata')
ans_choices <- c("Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree")
tdat <-
dat %>%
pivot_longer(Q1:Q10, names_to='qid', values_to = 'score') %>%
mutate(answer = case_when(score==1~ans_choices[1], score==2~ans_choices[2],
score==3~ans_choices[3], score==4~ans_choices[4],
score==5~ans_choices[5]),
neg_score= case_when(score < 3~1, score==3~0.5, score>3~0))
# Get cumulative totals for total_responses and tot_neg_responses
qdat <-
tdat %>%
group_by(qid) %>%
summarise(tot_responses = n(),
tot_neg_scores = sum(neg_score),
.groups="drop") %>%
full_join(qmet_dat %>%
rename(qid = QuestionID), by = 'qid') %>%
mutate(qnum = as.integer(substring(qid, 2)))%>%
arrange(qnum)
tdat2 <-
tdat %>%
group_by(qid, answer) %>%
summarise(
score = min(score),
num =n(),
.groups="drop") %>%
full_join(qdat, by="qid") %>%
mutate(pct = num/tot_responses,
answer = factor(answer, ans_choices)) %>%
arrange(answer, qnum)
positives <-
tdat2 %>%
filter(score >= 3) %>%
mutate(pct = if_else(score == 3, pct/2, pct))
negatives <-
tdat2 %>%
filter(score <= 3) %>%
mutate(pct = if_else(score == 3, -pct/2, -pct))
#my_cols <- c('#544914', '#A79129', '#A6A6A6', '#558ED5', '#17375F')
#my_cols <- c('#544914', '#A79129', '#A6A6A6', '#B5CCA8', '#8EB379')
my_cols <- c('red', 'pink', 'gray', 'cyan', 'blue')
ggplot() +
geom_bar(data=positives,
aes(x = reorder(Question, tot_neg_scores), y=pct, fill=answer),
position=position_stack(reverse = TRUE), stat="identity") +
geom_bar(data=negatives,
aes(x =reorder(Question, tot_neg_scores), y=pct, fill=answer) ,
position="stack", stat="identity") +
scale_fill_manual(values = my_cols, breaks = ans_choices) +
geom_hline(yintercept = 0, color =c("white"), lty=2)+
scale_y_continuous(limits = c(-1,1), labels = scales::percent) +
coord_flip()+
theme_tufte()+
labs(x ='', y='Percent', fill='', title = 'Hotel Survey') +
theme(plot.title = element_text(hjust = 0.5, size = 16, family = 'Arial', face='bold'),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'line'),
legend.text = element_text(size = 9, family = 'Arial'),
axis.text.y = element_text(size = 11, family = 'Arial'))
library(ggplot2)
library(RColorBrewer)
library(dplyr)
library(tidyr)
library(ggthemes)
tab <- readr::read_csv('data/ab3.csv')
levs <- c('Much worse', 'Somewhat worse', 'Almost the same', 'Somewhat better',  'Much better')
dat <-
tab %>%
pivot_longer(`Much worse`:`Much better`,
names_to = 'level', values_to='pct') %>%
mutate(level = factor(level, levs),
lev_num = as.numeric(level))
highs <-
dat %>%
filter(lev_num>=3) %>%
mutate(pct = if_else(lev_num == 3, pct/2, pct))
lows <-
dat %>%
filter(lev_num <= 3) %>%
mutate(pct = if_else(lev_num ==3, -pct/2, -pct))
mytitle<-"\"What do you think will be the economic situation in your country during the next\nfew years (3-5 years) compared to the current situation?\"\n"
pal <-brewer.pal(length(levs),"RdBu")
# Change middle value
pal[ceiling(length(levs)/2)]<-"#DFDFDF"
ggplot()+
geom_bar(data=highs, aes(Country, pct, fill=level),
position = position_stack(reverse = TRUE), stat='identity')+
geom_bar(data=lows, aes(Country, pct, fill=level),
position = 'stack', stat='identity')+
geom_hline(yintercept = 0, color =c("white")) +
scale_fill_manual(values = pal, breaks = levs)+
scale_y_continuous(breaks=seq(-1,1, 0.25), labels = scales::percent)+
#scale_y_continuous(breaks=seq(mymin,mymax,25), limits=c(mymin,mymax))+
coord_flip()+
theme_fivethirtyeight()+
labs(title = mytitle, x='',y='', fill='')+
theme(plot.title = element_text(size=14, hjust=0.5))+
theme(axis.text.y = element_text(hjust=0))+
theme(legend.position = "bottom")
#http://rnotr.com/likert/ggplot/barometer/likert-plots/
library(ggplot2)
library(reshape2)
library(RColorBrewer)
library(dplyr)
library(ggthemes)
library(stringr)
tab <- readr::read_csv('data/ab3.csv')
mytitle<-"\"What do you think will be the economic situation in your country during the next\nfew years (3-5 years) compared to the current situation?\"\n"
mylevels<-c("Much worse", "Somewhat worse", "Almost the same", "Somewhat better",  "Much better")
numlevels<-length(tab[1,])-1
numcenter<-ceiling(numlevels/2)+1
tab$midvalues <- tab[,numcenter]/2
tab2<-cbind(tab[,1],tab[,2:ceiling(numlevels/2)],
tab$midvalues,tab$midvalues,tab[,numcenter:numlevels+1])
colnames(tab2)<-c("outcome",mylevels[1:floor(numlevels/2)],"midlow",
"midhigh",mylevels[numcenter:numlevels])
numlevels<-length(mylevels)+1
point1<-2
point2<-((numlevels)/2)+1
point3<-point2+1
point4<-numlevels+1
mymin<-(ceiling(max(rowSums(tab2[,point1:point2]))*4)/4)*-100
mymax<-(ceiling(max(rowSums(tab2[,point3:point4]))*4)/4)*100
numlevels<-length(tab[1,])-1
temp.rows<-length(tab2[,1])
pal<-brewer.pal((numlevels-1),"RdBu")
pal[ceiling(numlevels/2)]<-"#DFDFDF"
legend.pal<-pal
pal<-c(pal[1:(ceiling(numlevels/2)-1)], pal[ceiling(numlevels/2)],
pal[ceiling(numlevels/2)], pal[(ceiling(numlevels/2)+1):(numlevels-1)])
tab3<-melt(tab2,id="outcome")
tab3$col<-rep(pal,each=temp.rows)
tab3$value<-tab3$value*100
tab3$outcome<-str_wrap(tab3$outcome, width = 40)
tab3$outcome<-factor(tab3$outcome, levels = tab2$outcome[order(-(tab2[,5]+tab2[,6]+tab2[,7]))])
highs<-na.omit(tab3[(length(tab3[,1])/2)+1:length(tab3[,1]),])
lows<-na.omit(tab3[1:(length(tab3[,1])/2),])
lows <- lows[rev(rownames(lows)),]
# Fixed Code
ggplot() +
geom_bar(data=highs, aes(x = outcome, y=value, fill=factor(col, levels = legend.pal)),position=position_stack(reverse = TRUE), stat="identity") +
geom_bar(data=lows, aes(x = outcome, y=-value, fill=factor(col, levels = legend.pal)), position='stack', stat="identity") +
geom_hline(yintercept = 0, color =c("white")) +
scale_fill_identity("", labels = mylevels, breaks=legend.pal, guide="legend") +
theme_fivethirtyeight() +
coord_flip() +
labs(title=mytitle, y="",x="") +
theme(plot.title = element_text(size=14, hjust=0.5)) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "bottom") +
scale_y_continuous(breaks=seq(mymin,mymax,25), limits=c(mymin,mymax))
tab3$outcome
tab3$outcome
tab2$outcome
#http://rnotr.com/likert/ggplot/barometer/likert-plots/
library(ggplot2)
library(reshape2)
library(RColorBrewer)
library(dplyr)
library(ggthemes)
library(stringr)
tab <- readr::read_csv('data/ab3.csv')
mytitle<-"\"What do you think will be the economic situation in your country during the next\nfew years (3-5 years) compared to the current situation?\"\n"
mylevels<-c("Much worse", "Somewhat worse", "Almost the same", "Somewhat better",  "Much better")
numlevels<-length(tab[1,])-1
numcenter<-ceiling(numlevels/2)+1
tab$midvalues <- tab[,numcenter]/2
tab2<-cbind(tab[,1],tab[,2:ceiling(numlevels/2)],
tab$midvalues,tab$midvalues,tab[,numcenter:numlevels+1])
colnames(tab2)<-c("outcome",mylevels[1:floor(numlevels/2)],"midlow",
"midhigh",mylevels[numcenter:numlevels])
numlevels<-length(mylevels)+1
point1<-2
point2<-((numlevels)/2)+1
point3<-point2+1
point4<-numlevels+1
mymin<-(ceiling(max(rowSums(tab2[,point1:point2]))*4)/4)*-100
mymax<-(ceiling(max(rowSums(tab2[,point3:point4]))*4)/4)*100
numlevels<-length(tab[1,])-1
temp.rows<-length(tab2[,1])
pal<-brewer.pal((numlevels-1),"RdBu")
pal[ceiling(numlevels/2)]<-"#DFDFDF"
legend.pal<-pal
pal<-c(pal[1:(ceiling(numlevels/2)-1)], pal[ceiling(numlevels/2)],
pal[ceiling(numlevels/2)], pal[(ceiling(numlevels/2)+1):(numlevels-1)])
tab3<-melt(tab2,id="outcome")
tab3$col<-rep(pal,each=temp.rows)
tab3$value<-tab3$value*100
tab3$outcome<-str_wrap(tab3$outcome, width = 40)
tab3$outcome <- factor(tab3$outcome, levels = tab2$outcome[order(-(tab2[,5]+tab2[,6]+tab2[,7]))])
highs<-na.omit(tab3[(length(tab3[,1])/2)+1:length(tab3[,1]),])
lows<-na.omit(tab3[1:(length(tab3[,1])/2),])
lows <- lows[rev(rownames(lows)),]
# Tutorial code
ggplot() + geom_bar(data=highs, aes(x = outcome, y=value, fill=col), position="stack", stat="identity") +
geom_bar(data=lows, aes(x = outcome, y=-value, fill=col), position="stack", stat="identity") +
geom_hline(yintercept = 0, color =c("white")) +
scale_fill_identity("Percent", labels = mylevels, breaks=legend.pal, guide="legend") +
theme_fivethirtyeight() +
coord_flip() +
labs(title=mytitle, y="",x="") +
theme(plot.title = element_text(size=14, hjust=0.5)) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "bottom") +
scale_y_continuous(breaks=seq(mymin,mymax,25), limits=c(mymin,mymax))
tab2[,5]
tab2[,6]
tab2
tab2
library(ggplot2)
library(RColorBrewer)
library(dplyr)
library(tidyr)
library(ggthemes)
tab <- readr::read_csv('data/ab3.csv')
tab2
tab2[,5]
tab
tab %>%
mutate(neg_score = 1/2*`Almost the same` + `Somewhat worse` + `Much worse`)
tab <- readr::read_csv('data/ab3.csv')
levs <- c('Much worse', 'Somewhat worse', 'Almost the same', 'Somewhat better',  'Much better')
dat <-
tab %>%
mutate(neg_score = 1/2*`Almost the same` + `Somewhat worse` + `Much worse`) %>%
pivot_longer(`Much worse`:`Much better`,
names_to = 'level', values_to='pct') %>%
mutate(level = factor(level, levs),
lev_num = as.numeric(level))
highs <-
dat %>%
filter(lev_num>=3) %>%
mutate(pct = if_else(lev_num == 3, pct/2, pct))
lows <-
dat %>%
filter(lev_num <= 3) %>%
mutate(pct = if_else(lev_num ==3, -pct/2, -pct))
mytitle<-"\"What do you think will be the economic situation in your country during the next\nfew years (3-5 years) compared to the current situation?\"\n"
pal <-brewer.pal(length(levs),"RdBu")
# Change middle value
pal[ceiling(length(levs)/2)]<-"#DFDFDF"
highs
ggplot()+
geom_bar(data=highs, aes(reorder(Country, neg_score), pct, fill=level),
position = position_stack(reverse = TRUE), stat='identity')+
geom_bar(data=lows, aes(reorder(Country, neg_score), pct, fill=level),
position = 'stack', stat='identity')+
geom_hline(yintercept = 0, color =c("white")) +
scale_fill_manual(values = pal, breaks = levs)+
scale_y_continuous(breaks=seq(-1,1, 0.25), labels = scales::percent)+
coord_flip()+
theme_fivethirtyeight()+
labs(title = mytitle, x='',y='', fill='')+
theme(plot.title = element_text(size=14, hjust=0.5))+
theme(axis.text.y = element_text(hjust=0))+
theme(legend.position = "bottom")
#http://rnotr.com/likert/ggplot/barometer/likert-plots/
library(ggplot2)
library(reshape2)
library(RColorBrewer)
library(dplyr)
library(ggthemes)
library(stringr)
tab <- readr::read_csv('data/ab3.csv')
mytitle<-"\"What do you think will be the economic situation in your country during the next\nfew years (3-5 years) compared to the current situation?\"\n"
mylevels<-c("Much worse", "Somewhat worse", "Almost the same", "Somewhat better",  "Much better")
numlevels<-length(tab[1,])-1
numcenter<-ceiling(numlevels/2)+1
tab$midvalues <- tab[,numcenter]/2
tab2<-cbind(tab[,1],tab[,2:ceiling(numlevels/2)],
tab$midvalues,tab$midvalues,tab[,numcenter:numlevels+1])
colnames(tab2)<-c("outcome",mylevels[1:floor(numlevels/2)],"midlow",
"midhigh",mylevels[numcenter:numlevels])
numlevels<-length(mylevels)+1
point1<-2
point2<-((numlevels)/2)+1
point3<-point2+1
point4<-numlevels+1
mymin<-(ceiling(max(rowSums(tab2[,point1:point2]))*4)/4)*-100
mymax<-(ceiling(max(rowSums(tab2[,point3:point4]))*4)/4)*100
numlevels<-length(tab[1,])-1
temp.rows<-length(tab2[,1])
pal<-brewer.pal((numlevels-1),"RdBu")
pal[ceiling(numlevels/2)]<-"#DFDFDF"
legend.pal<-pal
pal<-c(pal[1:(ceiling(numlevels/2)-1)], pal[ceiling(numlevels/2)],
pal[ceiling(numlevels/2)], pal[(ceiling(numlevels/2)+1):(numlevels-1)])
tab3<-melt(tab2,id="outcome")
tab3$col<-rep(pal,each=temp.rows)
tab3$value<-tab3$value*100
tab3$outcome<-str_wrap(tab3$outcome, width = 40)
tab3$outcome <- factor(tab3$outcome, levels = tab2$outcome[order(-(tab2[,5]+tab2[,6]+tab2[,7]))])
highs<-na.omit(tab3[(length(tab3[,1])/2)+1:length(tab3[,1]),])
lows<-na.omit(tab3[1:(length(tab3[,1])/2),])
lows <- lows[rev(rownames(lows)),]
# Tutorial code
ggplot() + geom_bar(data=highs, aes(x = outcome, y=value, fill=col), position="stack", stat="identity") +
geom_bar(data=lows, aes(x = outcome, y=-value, fill=col), position="stack", stat="identity") +
geom_hline(yintercept = 0, color =c("white")) +
scale_fill_identity("Percent", labels = mylevels, breaks=legend.pal, guide="legend") +
theme_fivethirtyeight() +
coord_flip() +
labs(title=mytitle, y="",x="") +
theme(plot.title = element_text(size=14, hjust=0.5)) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "bottom") +
scale_y_continuous(breaks=seq(mymin,mymax,25), limits=c(mymin,mymax))
# Fixed Code
ggplot() +
geom_bar(data=highs, aes(x = outcome, y=value, fill=factor(col, levels = legend.pal)),position=position_stack(reverse = TRUE), stat="identity") +
geom_bar(data=lows, aes(x = outcome, y=-value, fill=factor(col, levels = legend.pal)), position='stack', stat="identity") +
geom_hline(yintercept = 0, color =c("white")) +
scale_fill_identity("", labels = mylevels, breaks=legend.pal, guide="legend") +
theme_fivethirtyeight() +
coord_flip() +
labs(title=mytitle, y="",x="") +
theme(plot.title = element_text(size=14, hjust=0.5)) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "bottom") +
scale_y_continuous(breaks=seq(mymin,mymax,25), limits=c(mymin,mymax))
library(ggplot2)
library(RColorBrewer)
library(dplyr)
library(tidyr)
library(ggthemes)
tab <- readr::read_csv('data/ab3.csv')
levs <- c('Much worse', 'Somewhat worse', 'Almost the same', 'Somewhat better',  'Much better')
dat <-
tab %>%
mutate(neg_score = 1/2*`Almost the same` + `Somewhat worse` + `Much worse`) %>%
pivot_longer(`Much worse`:`Much better`,
names_to = 'level', values_to='pct') %>%
mutate(level = factor(level, levs),
lev_num = as.numeric(level))
highs <-
dat %>%
filter(lev_num>=3) %>%
mutate(pct = if_else(lev_num == 3, pct/2, pct))
lows <-
dat %>%
filter(lev_num <= 3) %>%
mutate(pct = if_else(lev_num ==3, -pct/2, -pct))
mytitle<-"\"What do you think will be the economic situation in your country during the next\nfew years (3-5 years) compared to the current situation?\"\n"
pal <-brewer.pal(length(levs),"RdBu")
# Change middle value
pal[ceiling(length(levs)/2)]<-"#DFDFDF"
ggplot()+
geom_bar(data=highs, aes(reorder(Country, neg_score), pct, fill=level),
position = position_stack(reverse = TRUE), stat='identity')+
geom_bar(data=lows, aes(reorder(Country, neg_score), pct, fill=level),
position = 'stack', stat='identity')+
geom_hline(yintercept = 0, color =c("white")) +
scale_fill_manual(values = pal, breaks = levs)+
scale_y_continuous(breaks=seq(-1,1, 0.25), labels = scales::percent)+
coord_flip()+
theme_fivethirtyeight()+
labs(title = mytitle, x='',y='', fill='')+
theme(plot.title = element_text(size=14, hjust=0.5))+
theme(axis.text.y = element_text(hjust=0))+
theme(legend.position = "bottom")
library(tidyverse)
library(scales)
library(ggthemes)
library(readxl)
dat <- read_excel('data/P18-Hotel-Survey-Data.xlsx', sheet = "Responses")
qmet_dat <- read_excel('data/P18-Hotel-Survey-Data.xlsx', sheet='Question Metadata')
ans_choices <- c("Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree")
tdat <-
dat %>%
pivot_longer(Q1:Q10, names_to='qid', values_to = 'score') %>%
mutate(answer = case_when(score==1~ans_choices[1], score==2~ans_choices[2],
score==3~ans_choices[3], score==4~ans_choices[4],
score==5~ans_choices[5]),
neg_score= case_when(score < 3~1, score==3~0.5, score>3~0))
# Get cumulative totals for total_responses and tot_neg_responses
qdat <-
tdat %>%
group_by(qid) %>%
summarise(tot_responses = n(),
tot_neg_scores = sum(neg_score),
.groups="drop") %>%
full_join(qmet_dat %>%
rename(qid = QuestionID), by = 'qid') %>%
mutate(qnum = as.integer(substring(qid, 2)))%>%
arrange(qnum)
tdat2 <-
tdat %>%
group_by(qid, answer) %>%
summarise(
score = min(score),
num =n(),
.groups="drop") %>%
full_join(qdat, by="qid") %>%
mutate(pct = num/tot_responses,
answer = factor(answer, ans_choices)) %>%
arrange(answer, qnum)
positives <-
tdat2 %>%
filter(score >= 3) %>%
mutate(pct = if_else(score == 3, pct/2, pct))
negatives <-
tdat2 %>%
filter(score <= 3) %>%
mutate(pct = if_else(score == 3, -pct/2, -pct))
#my_cols <- c('#544914', '#A79129', '#A6A6A6', '#558ED5', '#17375F')
#my_cols <- c('#544914', '#A79129', '#A6A6A6', '#B5CCA8', '#8EB379')
my_cols <- c('red', 'pink', 'gray', 'cyan', 'blue')
ggplot() +
geom_bar(data=positives,
aes(x = reorder(Question, tot_neg_scores), y=pct, fill=answer),
position=position_stack(reverse = TRUE), stat="identity") +
geom_bar(data=negatives,
aes(x =reorder(Question, tot_neg_scores), y=pct, fill=answer) ,
position="stack", stat="identity") +
scale_fill_manual(values = my_cols, breaks = ans_choices) +
geom_hline(yintercept = 0, color =c("white"), lty=2)+
scale_y_continuous(limits = c(-1,1), labels = scales::percent) +
coord_flip()+
theme_tufte()+
labs(x ='', y='Percent', fill='', title = 'Hotel Survey') +
theme(plot.title = element_text(hjust = 0.5, size = 16, family = 'Arial', face='bold'),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'line'),
legend.text = element_text(size = 9, family = 'Arial'),
axis.text.y = element_text(size = 11, family = 'Arial'))
plt <-
ggplot() +
geom_bar(data=positives,
aes(x = reorder(Question, tot_neg_scores), y=pct, fill=answer),
position=position_stack(reverse = TRUE), stat="identity") +
geom_bar(data=negatives,
aes(x =reorder(Question, tot_neg_scores), y=pct, fill=answer) ,
position="stack", stat="identity") +
scale_fill_manual(values = my_cols, breaks = ans_choices) +
geom_hline(yintercept = 0, color =c("white"), lty=2)+
scale_y_continuous(limits = c(-1,1), labels = scales::percent) +
coord_flip()+
theme_tufte()+
labs(x ='', y='Percent', fill='', title = 'Hotel Survey') +
theme(plot.title = element_text(hjust = 0.5, size = 16, family = 'Arial', face='bold'),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'line'),
legend.text = element_text(size = 9, family = 'Arial'),
axis.text.y = element_text(size = 11, family = 'Arial'))
plt
install.packages('plotly')
plotly::ggplotly(plt)
1
install.packages('Cairo')
plotly::ggplotly(plt)
library(Cairo)
plotly::ggplotly(plt)
plotly::plot_ly(plt)
